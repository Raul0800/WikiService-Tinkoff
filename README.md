# WikiService

## Описание
Реализация сервиса, работающиего с данными цитат из русскоязычной Википедии. 

## Основные возможности
Данный проект позволяет загружать данные из файла типа .json (дамп данных из Википедии) в базу данных - postgresql. После чего сервис
позволяет при помощи GET запросов:
1. Искать необходимую статью (по полному имени статьи).
2. Вывести статистику, описывающую количество статей по категориям.

## Подробности реализации
Основной стек примененных технологий:
1. scala
2. база данных postgresql
3. doobie
4. cats
5. circe
6. http4s
7. scalatest
8. pureconfig

Во время инициализации:
- Удаляются, если существуют таблицы public.Articles, public.Catalog
- Создаются таблицы public.Articles, public.Catalog
- Читается и разбирается файл формата .json
- Данные попадают в public.Articles
- Создается индекс в public.Articles по полю Title
- Добавляются данные в public.Catalog
- Создается связь между public.Articles и public.Catalog

Во время получения статистики:
- Все данные из public.Catalog передаются клиенту

Во время поиска статьи по заголовку:
- Проихводится поиск по таблице public.Articles по полю Title

## Cпособ запуска
Для запуска необходимо установить базу данных postgres!

Основные настроки, связанные с:
- указанием драйверов, url, логинов и паролей
- выбором адреса и порта на котором будет работать сервис
- указанием пути до файла .json

находятся в WikiService/src/main/resources/application.conf - конфигурационном файле, который считывается каждый раз при запуске сервиса.

## Endpoints
Приведем пример: 
<br />выберем 
<br />port=8080
<br />host="localhost"
<br />Тогда:
<br />GET -> http://localhost:8080/initialize - запускает инициализацию базы данных.
<br />GET -> http://localhost:8080/statistic - запускает вывод статистики.
<br />GET -> http://127.0.0.1:8080/wiki/<TitleName>?pretty - запускает поиск статьи по указанному имени. Вывод производится в читабельном формате.
<br />GET -> http://127.0.0.1:8080/wiki/<TitleName> - запускает поиск статьи по указанному имени. Вывод производится в виде одной строки.

## Возможные ответы от сервера:
<br />200 -> Done | успех
<br />400 -> com.example.service.CannotInitDB | невозможно инициализировать базу данных
<br />400 -> com.example.service.CannotReadSource | невозможно прочитать файл 
<br />400 -> com.example.service.SourceIsCorrupted | критическая проблема с содержанием файла
<br />400 -> com.example.service.CannotInsertData | невозможно вставить данные в базу данных
<br />400 -> com.example.service.CannotCreateReference | ошибка при созданнии связи между таблицами
<br />400 -> com.example.service.CannotUpdateData | ошибка при обновлении данных в базе данных
<br />400 -> com.example.service.CannotCreateIndex | ошибка при создании индекса в базе данных
<br />400 -> com.example.service.CannotGetStatistic | невозможно получить статистику по данным
<br />400 -> com.example.service.SearchError | ошибка во время поиска статьи
<br />400 -> Unknown command | указана неверная комманда в запросе
<br />400 -> Unexpected error | непредвиденная ошибка
